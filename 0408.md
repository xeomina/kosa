# 0408

## 복습

### 링크

* 도커 생성 - 이미지 push
  * 아이디 같으면 같은 디스크 공간
  * but 복사해놓은 것은 아님 !

### vi

```
# su - kosa
Last login: Thu Apr  7 17:30:24 KST 2022 on pts/1

$ pwd
/home/kosa

$ vi test
```

* test에 간단한 쉘 스크립트 작성
* 나중에 할 작업 미리 파일로 정리 > 실행

```vi
#!/bin/bash				/*bash 쉘 이용
yum update -y             
```

```
$ ll
total 4
-rw-rw-r--. 1 kosa kosa 26 Apr  8 09:47 test

$ ./test
-bash: ./test: Permission denied

$ chmod 764 test

$ ./test
Loaded plugins: fastestmirror
You need to be root to perform this command.
```

* yum 명령어는 root에서만 사용 가능...
  * 쉘 스크립트 실행은 됨



* `chmod a=rwx` : 777과 동일

```
$ chmod a=rwx test

$ ll
total 4
-rwxrwxrwx. 1 kosa kosa 26 Apr  8 09:47 test
```



* chown: 파일 소유자 변경

```
[root@localhost ~]# cd ~kosa
[root@localhost kosa]# ll
total 4
-rwxrwxrwx. 1 kosa kosa 26 Apr  8 09:47 test
[root@localhost kosa]# chmod 000 test
```

```
[kosa@localhost ~]$ ll
total 4
----------. 1 kosa kosa 26 Apr  8 09:47 test
```

```
[root@localhost kosa]# chown root:root test
[root@localhost kosa]# ll
total 4
----------. 1 root root 26 Apr  8 09:47 test
```

```
[kosa@localhost ~]$ ll
total 4
----------. 1 kosa kosa 26 Apr  8 09:47 test
[kosa@localhost ~]$ chmod 777 test
chmod: changing permissions of ‘test’: Operation not permitted
```



### 쉘 명령어

* echo를 통해 변수에 저장된 값 알 수 있음

```
# env | grep "USER"
USER=root
USERNAME=root

# echo $USER
root
```



### 사용자 초기화 파일

* alias ans = 'ansible'
* alias k = 'kubectl' (Kubernetes)



### 프로세스 확인

```
# cat /etc/passwd | grep kosa
kosa:x:1000:1000::/home/kosa:/bin/bash			/* ID

# pgrep -u 1000
2404

# pgrep -lt pts/1
2385 bash
2403 su
2404 bash
```



### kill

```
# top
# yes > /dev/null &
# pkill yes
# pgrep -l yes

```



## 아카이브

### tar 명령어

* 압축보다는 여러 파일을 하나로 모아주는 것
  * 크기나 용량 줄어들지 않음

* c: 새로운 tar 파일을 생성
  t: tar 파일 내부 내용 확인
  x: tar 파일을 해제합니다.
  f: 아카이브 파일 지정
  v: tar 명령어 수행 과정 출력

* - tar 명령어를 이용한 아카이브 생성 (jar, war 유사)





* 옵션에 `-` 붙이지 않는 경우 ?

```
# tar cvf archive.tar dirA fileD numbers
# tar tvf archive.tar
# mkdir test
# cd test
# tar xvf ../archive.tar
```



### 압축 및 압축 해제



#### compress 파일

> .z

**compress 파일 압축**

```
# yum install ncompress -y
# ll
# compress -v process_list
# ll

# zcat process_list.Z
# compress -v archive.tar
# ll

# zcat archive.tar.Z | tar xvf -

# uncompress -c process_list.Z		/* 내용 확인
```



**uncompress 압축 해제**

```
# uncompress -v archive.tar.Z
# uncompress -v process_list.Z
# ls -l
```



#### gzip 파일

> .gz

**gzip 파일 압축**

```
# gzip process_list
# ls -l

# zcat process_list.gz
```



**gunzip 압축 해제**

```
# gunzip process_list.gz
# ls -l
```



**아카이브된 파일 또는 디렉토리 압축 및 해제**

* zcvf : `.tar` 파일을 `.gz`로 압축
* ztvf : 내용 확인
* zxvf : 압축 해제
  * 삭제된 dirB 복구 + tar.gz 유지

```
# tar zcvf test.tar.gz dirB
# ls -l

# tar ztvf test.tar.gz
# rm -rf dirB

# tar zxvf test.tar.gz
# ls -l
```



* `-C` : 압축 해제할 폴더 지정

```
# mkdir archive
# tar zxvf archive.tar.gz -C archive
# ll archive
total 12
-rw-r--r--. 1 root root 10240 Apr  8 11:50 archive.tar
```



#### bzip2 파일

> .bz2

**bzip2 파일 압축**

```
# bzip2 process_list		/* 압축
# bzcat process_list.bz2	/* 내용확인
```



**bunzip 압축 해제**

```
# bunzip2 process_list.bz2
```



**아카이브된 파일 또는 디렉토리 압축 및 해제**

* jcvf: `.tar` 파일을 `.bz2`로 압축
* jtvf : 내용 확인
* jxvf: 압축 해제

```
# tar jcvf test.tar.bz2 dirB
# tar jtvf test.tar.bz2 dirB
# tar jxvf test.tar.bz2
```

```
# mkdir archive-bz2
# tar jxvf test.tar.bz2 -C archive-bz2
```



#### zip 파일 또는 디렉토리

> .zip

**zip 파일 압축**

```
# zip test.zip dirB/*
```

**zip 파일 압축해제**

```
# rm -rf dirB

# unzip test.zip
```

